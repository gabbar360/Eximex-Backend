<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Proforma Invoice</title>
    <style>
        :root {
            --outer: 2px solid #000;
            --inner: 1px solid #000;
            --grey: #e0e0e0;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 10px;
            margin: 10px;
        }

        .page {
            border: var(--outer);
        }

        .title {
            background: var(--grey);
            text-align: center;
            font-weight: 700;
            font-size: 16px;
            padding: 6px 8px;
            border-bottom: var(--inner);
        }

        .subtitle {
            text-align: center;
            padding: 6px 8px;
            border-bottom: var(--inner);
            font-size: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: var(--inner);
            padding: 6px;
            vertical-align: top;
        }

        .header {
            background: var(--grey);
            font-weight: bold;
        }

        .center {
            text-align: center;
        }

        .right {
            text-align: right;
        }

        .bold {
            font-weight: bold;
        }

        .table-title {
            text-align: center;
            border-left: var(--inner);
            border-right: var(--inner);
            border-bottom: var(--inner);
            background: var(--grey);
            padding: 6px 4px;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="page">
        <div class="title"><%= piInvoice.isSampleKit ? 'SAMPLE KIT PROFORMA INVOICE' : 'PROFORMA INVOICE' %></div>
        <div class="subtitle">SUPPLY MEANT FOR EXPORT UNDER BOND & LUT - LETTER OF UNDERTAKING WITHOUT PAYMENT OF INTEGRATED TAX</div>

        <table>
            <tr>
                <td rowspan="3" style="width: 60%;">
                    <div style="display: flex; align-items: flex-start; gap: 10px;">
                        <div style="flex: 1;">
                            <div class="bold" style="text-decoration: underline;">EXPORTER:</div>
                            <div class="bold" style="margin-top: 4px; font-size: 12px;">
                                <%= piInvoice.company?.name || 'COMPANY NAME' %>
                     e stock.

       </div>
                            <div><%= piInvoice.company?.address || 'Company Address' %></div>
                            <div>
                                <%= piInvoice.company.city || '' %>
                    e stock.

            <%= piInvoice.company.state ? ', ' + piInvoice.company.state : '' %>
                                <%= piInvoice.company.pincode ? ', ' + piInvoice.company.pincode : '' %>
                            </div>
                            <div>Phone: <%= piInvoice.company.phoneNo || '+91-XXXXXXXXXX' %></div>
                            <div>Email: <%= piInvoice.company.email || 'email@company.com' %></div>
                        </div>
                        <div style="text-align:right;">
                            <% const logoUrl=piInvoice.company?.logo; %>
                            <% const fullLogoUrl=logoUrl ? (logoUrl.startsWith('http') ? logoUrl : `http://localhost:8000${logoUrl}`) : null; %>
                            <% if (typeof logoBase64 !=='undefined' && logoBase64) { %>
                                <img src="data:image/*;base64,<%= logoBase64 %>" alt="Company Logo" style="max-height: 80px; max-width: 200px; object-fit: contain; border-radius: 8px; border: none; padding: 4px;">
                            <% } else if (fullLogoUrl) { %>
                                <img src="<%= fullLogoUrl %>" alt="Company Logo" style="max-height: 80px; max-width: 200px; object-fit: contain; border-radius: 8px; border: none; padding: 4px;">
                            <% } %>
                        </div>
                    </div>
                </td>
                <td style="width: 20%;" class="center">
                    <div class="bold">Performa Invoice No:</div>
                    <div class="bold" style="font-size: 12px; margin-top: 2px;">
                        <%= piInvoice.piNumber %>
                    </div>
                </td>
                <td style="width: 20%;" class="center">
                    <div class="bold">Date:</div>
                    <div class="bold" style="font-size: 12px; margin-top: 2px;">
                        <%= new Date(piInvoice.invoiceDate || piInvoice.createdAt).toLocaleDateString('en-GB', { day:'2-digit', month:'long', year:'numeric' }) %>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2" class="bold">Buyer's Ref No. & Date :-</td>
            </tr>
            <tr>
                <td colspan="2">
                    <div class="bold">Terms & Conditions :-</div>
                    <ol style="margin: 4px 0 0 16px; padding: 0;">
                        <% if (piInvoice.deliveryTerm) { %>
                            <li>TRADE TERM: <%= piInvoice.deliveryTerm.toUpperCase() %></li>
                        <% } %>
                        <% if (piInvoice.paymentTerm) { %>
                            <% 
                                // Format payment term based on advance percentage and balance term
                                let formattedPaymentTerm = piInvoice.paymentTerm;
                                if (piInvoice.paymentTerm === 'advance' && piInvoice.advancePercentage) {
                                    const advance = parseInt(piInvoice.advancePercentage);
                                    const balance = 100 - advance;
                                    if (balance > 0 && piInvoice.balancePaymentTerm) {
                                        formattedPaymentTerm = `${advance}% ADVANCE. ${balance}% ${piInvoice.balancePaymentTerm}`;
                                    } else {
                                        formattedPaymentTerm = `${advance}% ADVANCE`;
                                    }
                                } else {
                                    formattedPaymentTerm = piInvoice.paymentTerm.toUpperCase();
                                }
                            %>
                            <li>PAYMENT TERM: <%= formattedPaymentTerm %></li>
                        <% } %>
                    </ol>
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="header">CONSIGNEE:</td>
                <td class="header">BUYER</td>
                <td class="header">NOTIFY PARTY (Other then Buyer)</td>
            </tr>
            <tr>
                <td style="width: 40%;">
                    <% if (piInvoice.showToTheOrder) { %>
                        <div class="bold" style="margin-top:2px; text-align: center; font-size: 14px;">
                            TO THE ORDER
                        </div>
                    <% } else { %>
                        <div class="bold" style="margin-top:2px;">
                            <%= piInvoice.partyName || piInvoice.party?.companyName || '-' %>
                        </div>
                        <div>Address: <%= piInvoice.address || piInvoice.party?.address || '' %></div>
                        <div><%= piInvoice.country || piInvoice.party?.country || '' %></div>
                        <% if (piInvoice.phone || piInvoice.party?.phone) { %>
                            <div>Phone: <%= piInvoice.phone || piInvoice.party?.phone %></div>
                        <% } %>
                        <% if (piInvoice.email || piInvoice.party?.email) { %>
                            <div>Email: <%= piInvoice.email || piInvoice.party?.email %></div>
                        <% } %>
                    <% } %>
                </td>
                <td style="width: 40%;">
                    <div class="bold" style="margin-top:2px;">
                        <%= piInvoice.partyName || piInvoice.party?.companyName || 'N/A' %>
                    </div>
                    <div>Address: <%= piInvoice.address || piInvoice.party?.address || '' %></div>
                    <% if (piInvoice.phone || piInvoice.party?.phone) { %>
                        <div>Phone: <%= piInvoice.phone || piInvoice.party?.phone %></div>
                    <% } %>
                    <% if (piInvoice.email || piInvoice.party?.email) { %>
                        <div>Email: <%= piInvoice.email || piInvoice.party?.email %></div>
                    <% } %>
                </td>
                <td style="width: 20%;"></td>
            </tr>
        </table>

        <table>
            <tr class="center header">
                <td>Pre Carriage By</td>
                <td>Place of Receipt by Pre-Carrier</td>
                <td>Country of Origin of Goods</td>
                <td>Country of Final Destination</td>
            </tr>
            <tr class="center">
                <td><%= piInvoice.preCarriageBy || '-' %></td>
                <td><%= piInvoice.placeOfReceipt || '-' %></td>
                <td><%= piInvoice.countryOfOrigin || 'INDIA' %></td>
                <td><%= piInvoice.countryOfDestination || piInvoice.country || '-' %></td>
            </tr>
            <tr class="center header">
                <td>Vessel/ Flight No</td>
                <td>Port of Loading</td>
                <td>Port of Discharge</td>
                <td>Final Destination</td>
            </tr>
            <tr class="center">
                <td><%= piInvoice.vesselFlightNo || '-' %></td>
                <td><%= piInvoice.portOfLoading || '-' %></td>
                <td><%= piInvoice.portOfDischarge || '-' %></td>
                <td><%= piInvoice.finalDestination || '-' %></td>
            </tr>
        </table>

        <div class="table-title">Description of Goods</div>
        <% 
            // Based on unit type (if tiles always use sqm/sqft)
            const hasTilesProducts = piInvoice.products.some(product => {
                const tilesUnits = ['sqm', 'sqft', 'square meter'];
                const isTilesProduct = tilesUnits.includes(product.unit?.toLowerCase()) && 
                                      ((product.calculatedBoxes && product.calculatedBoxes > 0) || 
                                       (product.calculatedPallets && product.calculatedPallets > 0));
                return isTilesProduct;
            });
        %>
        <table>
            <thead>
                <% if (hasTilesProducts) { %>
                    <tr class="header center">
                        <th style="width: 3%;">S.No.</th>
                        <th style="width: 28%;">Description of Goods</th>
                        <th style="width: 6%;">No. of CNTRs</th>
                        <th style="width: 7%;">HS Code</th>
                        <th style="width: 8%;">Quantity</th>
                        <th style="width: 5%;">Unit</th>
                        <th style="width: 7%;">Total Boxes</th>
                        <th style="width: 7%;">Total Pallets</th>
                        <th style="width: 8%;">Rate <%= piInvoice.currency || 'USD' %></th>
                        <th style="width: 8%;">Weight (Kgs)</th>
                        <th style="width: 10%;">Amount <%= piInvoice.currency || 'USD' %></th>
                    </tr>
                <% } else { %>
                    <tr class="header center">
                        <th style="width: 4%;">S.No.</th>
                        <th style="width: 40%;">Description of Goods</th>
                        <th style="width: 8%;">HS Code</th>
                        <th style="width: 10%;">Quantity</th>
                        <th style="width: 6%;">Unit</th>
                        <th style="width: 10%;">Rate <%= piInvoice.currency || 'USD' %></th>
                        <th style="width: 10%;">Weight (Kgs)</th>
                        <th style="width: 12%;">Amount <%= piInvoice.currency || 'USD' %></th>
                    </tr>
                <% } %>
            </thead>
            <tbody>
                <% let sumAmount=0, totalNet=0, totalGross=0, totalQuantity=0, totalBoxes=0, totalPallets=0; %>
                <% 
                    // Number formatting function for Indian format
                    function formatNumber(num) {
                        if (!num || isNaN(num)) return '0.00';
                        return parseFloat(num).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                    }
                    
                    // Calculate total containers from products
                    const uniqueContainers = new Set();
                    piInvoice.products.forEach(product => {
                        const containerNum = product.containerNumber || 1;
                        uniqueContainers.add(containerNum);
                    });
                    const totalContainers = piInvoice.totalContainers || uniqueContainers.size || 1;
                %>
                <% piInvoice.products.forEach((product, index) => { %>
                    <% const lineAmt = Number(product.total || 0) || 0; %>
                    <% const net = product.totalWeight ? (parseFloat(product.totalWeight) * 0.9) : 0; %>
                    <% const gross = product.totalWeight ? parseFloat(product.totalWeight) : 0; %>
                    <% sumAmount += lineAmt; totalNet += net; totalGross += gross; %>
                    <% totalQuantity += parseFloat(product.quantity || 0); %>
                    <% 
                        // Based on unit type (if tiles always use sqm/sqft)
                        const tilesUnits = ['sqm', 'sqft', 'square meter'];
                        const isTilesProduct = tilesUnits.includes(product.unit?.toLowerCase()) && 
                                              ((product.calculatedBoxes && product.calculatedBoxes > 0) || 
                                               (product.calculatedPallets && product.calculatedPallets > 0));
                        if (isTilesProduct) {
                            totalBoxes += parseFloat(product.calculatedBoxes || 0);
                            totalPallets += parseFloat(product.calculatedPallets || 0);
                        }
                    %>
                    <% if (hasTilesProducts) { %>
                        <tr>
                            <td class="center"><%= index + 1 %></td>
                            <td>
                                <strong><%= product.productName || '-' %></strong>
                                <% if (product.productDescription && product.productDescription !== product.productName) { %>
                                    <br><%= product.productDescription %>
                                <% } %>
                            </td>
                            <td class="center"><%= product.containerCount || 1 %></td>
                            <td class="center"><%= (product.hsCode && product.hsCode !== 'N/A') ? product.hsCode : (product.hsnCode && product.hsnCode !== 'N/A') ? product.hsnCode : product.category?.hsnCode || product.product?.category?.hsnCode || product.product?.hsCode || product.product?.hsnCode || 'N/A' %></td>
                            <td class="right"><%= product.quantity || 0 %></td>
                            <td class="center"><%= product.unit || 'PCS' %></td>
                            <td class="center">
                                <% if (isTilesProduct && product.calculatedBoxes) { %>
                                    <%= product.calculatedBoxes %>
                                <% } else { %>
                                    -
                                <% } %>
                            </td>
                            <td class="center">
                                <% if (isTilesProduct && product.calculatedPallets) { %>
                                    <%= product.calculatedPallets %>
                                <% } else { %>
                                    -
                                <% } %>
                            </td>
                            <td class="right"><%= formatNumber(product.rate || 0) %></td>
                            <td class="right"><%= gross ? gross.toFixed(0) + 'kg' : '0kg' %></td>
                            <td class="right"><%= piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$' %> <%= formatNumber(product.total || 0) %></td>
                        </tr>
                    <% } else { %>
                        <tr>
                            <td class="center"><%= index + 1 %></td>
                            <td>
                                <strong><%= product.productName || '-' %></strong>
                                <% if (product.productDescription && product.productDescription !== product.productName) { %>
                                    <br><%= product.productDescription %>
                                <% } %>
                            </td>
                            <td class="center"><%= (product.hsCode && product.hsCode !== 'N/A') ? product.hsCode : (product.hsnCode && product.hsnCode !== 'N/A') ? product.hsnCode : product.category?.hsnCode || product.product?.category?.hsnCode || product.product?.hsCode || product.product?.hsnCode || 'N/A' %></td>
                            <td class="right"><%= product.quantity || 0 %></td>
                            <td class="center"><%= product.unit || 'PCS' %></td>
                            <td class="right"><%= formatNumber(product.rate || 0) %></td>
                            <td class="right"><%= gross ? gross.toFixed(0) + 'kg' : '0kg' %></td>
                            <td class="right"><%= piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$' %> <%= formatNumber(product.total || 0) %></td>
                        </tr>
                    <% } %>
                <% }) %>
                <% if (hasTilesProducts) { %>
                    <tr class="bold header">
                        <td class="center">TOTAL</td>
                        <td></td>
                        <td class="center"><%= totalContainers %></td>
                        <td></td>
                        <td class="right"><%= formatNumber(totalQuantity) %></td>
                        <td></td>
                        <td class="center"><%= totalBoxes > 0 ? totalBoxes : '-' %></td>
                        <td class="center"><%= totalPallets > 0 ? totalPallets : '-' %></td>
                        <td></td>
                        <td class="right"><%= totalGross ? totalGross.toFixed(0) + 'kg' : '0kg' %></td>
                        <td class="right"><%= piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$' %> <%= formatNumber(sumAmount) %></td>
                    </tr>
                <% } else { %>
                    <tr class="bold header">
                        <td colspan="6" class="center">SUB TOTAL</td>
                        <td></td>
                        <td class="right"><%= piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$' %> <%= formatNumber(sumAmount) %></td>
                    </tr>
                <% } %>
                <% if (hasTilesProducts) { %>
                    <tr class="bold">
                        <td colspan="11">
                            NET WEIGHT:- <%= (piInvoice.totalWeight || totalNet).toFixed(1) %> KG<br>
                            GROSS WEIGHT:- <%= (piInvoice.totalGrossWeight || totalGross).toFixed(1) %> KG
                        </td>
                    </tr>
                <% } else { %>
                    <tr class="bold">
                        <td colspan="8">
                            NET WEIGHT:- <%= (piInvoice.totalWeight || totalNet).toFixed(1) %> KG<br>
                            GROSS WEIGHT:- <%= (piInvoice.totalGrossWeight || totalGross).toFixed(1) %> KG
                        </td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <% let charges = 0; %>
        <% if (piInvoice.charges) { %>
            <% Object.entries(piInvoice.charges).forEach(([key, value]) => { %>
                <% if (key === 'otherCharges' && Array.isArray(value)) { %>
                    <% value.forEach((charge) => { charges += parseFloat(charge.amount || 0); }); %>
                <% } else if (key === 'dutyPercent') { %>
                    <% const dutyAmount = (piInvoice.subtotal || sumAmount) * (parseFloat(value || 0) / 100); %>
                    <% charges += dutyAmount; %>
                <% } else if (key !== 'noOtherCharges') { %>
                    <% charges += parseFloat(value || 0); %>
                <% } %>
            <% }); %>
        <% } %>
        <% const totalAmount = sumAmount + charges; %>

        <table>
            <tr>
                <td style="width: 70%;">
                    <div class="bold">AMOUNT IN WORDS (<%= piInvoice.currency || 'USD' %>) :-</div>
                    <% 
                        const finalAmount = totalAmount;
                        function numberToWords(num) {
                            const ones = ['', 'ONE', 'TWO', 'THREE', 'FOUR', 'FIVE', 'SIX', 'SEVEN', 'EIGHT', 'NINE', 'TEN', 'ELEVEN', 'TWELVE', 'THIRTEEN', 'FOURTEEN', 'FIFTEEN', 'SIXTEEN', 'SEVENTEEN', 'EIGHTEEN', 'NINETEEN'];
                            const tens = ['', '', 'TWENTY', 'THIRTY', 'FORTY', 'FIFTY', 'SIXTY', 'SEVENTY', 'EIGHTY', 'NINETY'];
                            
                            if (num === 0) return 'ZERO';
                            if (num < 20) return ones[num];
                            if (num < 100) return tens[Math.floor(num/10)] + (num%10 ? ' ' + ones[num%10] : '');
                            if (num < 1000) return ones[Math.floor(num/100)] + ' HUNDRED' + (num%100 ? ' ' + numberToWords(num%100) : '');
                            if (num < 1000000) return numberToWords(Math.floor(num/1000)) + ' THOUSAND' + (num%1000 ? ' ' + numberToWords(num%1000) : '');
                            return numberToWords(Math.floor(num/1000000)) + ' MILLION' + (num%1000000 ? ' ' + numberToWords(num%1000000) : '');
                        }
                        const currencyWord = piInvoice.currency === 'INR' ? 'RUPEES' : piInvoice.currency === 'EUR' ? 'EUROS' : 'DOLLARS';
                        const amountInWords = finalAmount ? numberToWords(Math.floor(finalAmount)) + ' ' + currencyWord + ' ONLY' : '';
                    %>
                    <%= amountInWords %>
                </td>
                <td style="width: 30%;">
                    <table style="width:100%; border-collapse:collapse;">
                        <% if (piInvoice.charges && Object.keys(piInvoice.charges).length > 0) { %>
                            <% 
                                // Calculate duty amount and other charges separately
                                let dutyAmount = 0;
                                let otherChargesTotal = 0;
                                let dutyPercent = 0;
                                
                                Object.entries(piInvoice.charges).forEach(([key, value]) => {
                                    if (key === 'dutyPercent') {
                                        dutyPercent = parseFloat(value || 0);
                                        dutyAmount = (piInvoice.subtotal || sumAmount) * (dutyPercent / 100);
                                    } else if (key === 'otherCharges' && Array.isArray(value)) {
                                        value.forEach((charge) => {
                                            otherChargesTotal += parseFloat(charge.amount || 0);
                                        });
                                    } else if (key !== 'noOtherCharges') {
                                        otherChargesTotal += parseFloat(value || 0);
                                    }
                                });
                            %>
                            
                            <% if (dutyAmount > 0) { %>
                                <tr>
                                    <td style="border: var(--inner); padding:8px 6px; font-weight:bold;">
                                        Duty (<%= dutyPercent %>%):
                                    </td>
                                    <td class="right" style="border: var(--inner); padding:8px 6px; font-weight:bold;">
                                        <%= (piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$') + formatNumber(dutyAmount) %>
                                    </td>
                                </tr>
                            <% } %>
                            
                            <% if (otherChargesTotal > 0) { %>
                                <tr>
                                    <td style="border: var(--inner); padding:8px 6px; font-weight:bold;">
                                        Freight Charges and Other:
                                    </td>
                                    <td class="right" style="border: var(--inner); padding:8px 6px; font-weight:bold;">
                                        <%= (piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$') + formatNumber(otherChargesTotal) %>
                                    </td>
                                </tr>
                            <% } %>
                        <% } %>
                        <tr>
                            <td style="border: var(--inner); padding:8px 6px; font-weight:bold;">Total Invoice Amount:</td>
                            <td class="right" style="border: var(--inner); padding:8px 6px; font-weight:bold;">
                                <%= piInvoice.currency === 'INR' ? '₹' : piInvoice.currency === 'EUR' ? '€' : '$' %> <%= formatNumber(totalAmount) %>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="header" colspan="2">BANK DETAILS :-</td>
            </tr>
            <tr>
                <td style="width: 80%; padding: 10px; vertical-align: top;">
                    <div style="font-size: 10px; margin-bottom: 2px;"><strong>BANK NAME :-</strong> <%= piInvoice.company.bankName || 'N/A' %></div>
                    <div style="font-size: 10px; margin-bottom: 2px;"><strong>BANK ADDRESS :-</strong> <%= piInvoice.company.bankAddress || '' %></div>
                    <div style="font-size: 10px; margin-bottom: 2px;"><strong>ACCOUNT NUMBER :-</strong> <%= piInvoice.company.accountNumber || 'N/A' %></div>
                    <div style="font-size: 10px; margin-bottom: 2px;"><strong>IFSC CODE :-</strong> <%= piInvoice.company.ifscCode || 'N/A' %></div>
                    <div style="font-size: 10px;"><strong>SWIFT CODE :-</strong> <%= piInvoice.company.swiftCode || 'N/A' %></div>
                </td>
                <td style="width: 20%; text-align: center; vertical-align: top; padding: 10px;">
                    <div style="margin-bottom: 10px;">
                        <strong>For, <%= piInvoice.company?.name || 'COMPANY NAME' %></strong>
                    </div>
                    <div style="height: 60px; display: flex; align-items: center; justify-content: center;">
                        <% const signatureUrl = piInvoice.company?.signature; %>
                        <% const fullSignatureUrl = signatureUrl ? (signatureUrl.startsWith('http') ? signatureUrl : `http://localhost:8000${signatureUrl}`) : null; %>
                        <% if (typeof signatureBase64 !== 'undefined' && signatureBase64) { %>
                            <img src="data:image/*;base64,<%= signatureBase64 %>" alt="Signature" style="max-height: 50px; max-width: 80px; object-fit: contain;">
                        <% } else if (fullSignatureUrl) { %>
                            <img src="<%= fullSignatureUrl %>" alt="Signature" style="max-height: 50px; max-width: 80px; object-fit: contain;">
                        <% } else { %>
                            <div style="width: 80px; height: 50px; border: 1px dashed #ccc; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #999;">
                                SIGNATURE
                            </div>
                        <% } %>
                    </div>
                    <div style="margin-top: 8px;">
                        <div style="border-bottom: 1px solid #000; width: 80px; margin: 0 auto;"></div>
                        <div style="font-size: 8px; margin-top: 2px;">Authorised Signatory</div>
                    </div>
                </td>
            </tr>
        </table>

        <% if (piInvoice.notes && piInvoice.notes.trim()) { %>
        <table>
            <tr>
                <td class="header" style="background: var(--grey); font-weight: bold; padding: 6px;">NOTES:</td>
            </tr>
            <tr>
                <td style="padding: 6px; vertical-align: top; font-size: 10px; line-height: 1.3; border: var(--inner); white-space: pre-line;">
                    <%= piInvoice.notes %>
                </td>
            </tr>
        </table>
        <% } %>

        <table>
            <tr>
                <td style="padding: 10px; vertical-align: top;">
                  
                    <div>
                        We Declare that this Invoice shows the Actual prices of the goods described and that particulars are true and correct.
                    </div>
                </td>
            </tr>
        </table>
    </div>
</body>

</html>