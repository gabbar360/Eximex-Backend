<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VGM Document - <%= vgm.productPackagingStep?.containerNumber || 'VGM-' + vgm.id %>
    </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            line-height: 1.2;
            color: #000;
            padding: 20px;
        }

        .company-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #000;
        }

        .company-info {
            flex: 1;
        }

        .company-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .company-details {
            font-size: 10px;
            line-height: 1.3;
        }

        .logo-img {
            width: 200px;
            height: 120px;
            object-fit: contain;
            border-radius: 50%;
            border: 1px solid #ddd;
            padding: 4px;
        }

        /* Logo header styling for VGM document */
        .logo-header {
            text-align: center;
            padding: 10px;
            margin-bottom: 20px;
        }

        .logo-header img {
            max-width: 120px;
            max-height: 70px;
            object-fit: contain;
            border-radius: 8px;
            border: none;
            padding: 4px;
        }

        .header {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            text-decoration: underline;
            margin-bottom: 20px;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .info-table th,
        .info-table td {
            border: 2px solid #000;
            padding: 8px;
            text-align: left;
            vertical-align: top;
        }

        .info-table th {
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .sr-no {
            width: 60px;
            text-align: center;
            font-weight: bold;
        }

        .details {
            width: 50%;
        }

        .particulars {
            width: 40%;
        }

        .container-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 50px;
        }

        .container-table th,
        .container-table td {
            border: 2px solid #000;
            padding: 8px;
            text-align: center;
            font-weight: bold;
        }

        .container-table th {
            background-color: #f0f0f0;
            font-size: 11px;
        }

        .signature-section {
            text-align: center;
            margin-top: 50px;
        }

        .signature-text {
            font-size: 14px;
            margin-bottom: 20px;
        }

        .signature-space {
            height: 80px;
            margin: 20px 0;
        }

        @media print {
            body {
                padding: 10px;
            }
        }
    </style>
</head>

<body>
    <!-- Logo Header -->
    <div class="logo-header">
        <% const logoUrl = company?.logo; %>
        <% const fullLogoUrl = logoUrl ? (logoUrl.startsWith('http') ? logoUrl : `http://localhost:8000${logoUrl}`) : null; %>
        <% if (typeof logoBase64 !== 'undefined' && logoBase64) { %>
            <img src="data:image/*;base64,<%= logoBase64 %>" alt="Company Logo">
        <% } else if (fullLogoUrl) { %>
            <img src="<%= fullLogoUrl %>" alt="Company Logo">
        <% } %>
    </div>

    <div class="header">
        INFORMATION ABOUT VERIFIED GROSS MASS OF CONTAINER
    </div>

    <table class="info-table">
        <thead>
            <tr>
                <th class="sr-no">Sr No.</th>
                <th class="details">Details of information</th>
                <th class="particulars">Particulars</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="sr-no">1*</td>
                <td>Name of the shipper</td>
                <td>
                    <%= company.name || 'N/A' %>
                </td>
            </tr>
            <tr>
                <td class="sr-no">2*</td>
                <td>Shipper Registration /License no. (IEC No/CIN No) **</td>
                <td>
                    <%= company.iecNumber || 'N/A' %>
                </td>
            </tr>
            <tr>
                <td class="sr-no">3*</td>
                <td>Name and designation of official of the shipper authorized to sign document</td>
                <td>
                    <%= vgm.verifiedBy %>
                        <% if (vgm.verifierPosition) { %>, <%= vgm.verifierPosition %>
                                <% } %>
                </td>
            </tr>
            <tr>
                <td class="sr-no">4*</td>
                <td>24 x 7 contact details of authorized official of shipper</td>
                <td>
                    <%= company.phoneNo || 'N/A' %>
                </td>
            </tr>
            <tr>
                <td class="sr-no">5*</td>
                <td>Container No.</td>
                <td>AS PER BELOW DETAILS</td>
            </tr>
            <tr>
                <td class="sr-no">6*</td>
                <td>Container Size (TEU/FEU/other)</td>
                <td>
                    <%= piInvoice.containerType || 'N/A' %>
                </td>
            </tr>

            <tr>
                <td class="sr-no">7*</td>
                <td>Maximum permissible weight of container as per the CSC plate</td>
                <td>AS PER BELOW DETAILS</td>
            </tr>
            <tr>
                <td class="sr-no">8*</td>
                <td>Weighbridge registration no. & Address of Weighbridge</td>
                <td>
                    <%= vgm.weighingLocation || '' %>
                </td>
            </tr>
            <tr>
                <td class="sr-no">9*</td>
                <td>Verified gross mass of container (method-1/method-2)</td>
                <td>AS PER BELOW DETAILS</td>
            </tr>
            <tr>
                <td class="sr-no">10*</td>
                <td>Date and time of weighing</td>
                <td>
                    <%= new Date(vgm.verificationDate).toLocaleDateString('en-GB') %>, <%= new
                            Date(vgm.verificationDate).toLocaleTimeString('en-GB', { hour: '2-digit' , minute: '2-digit'
                            }) %>
                </td>
            </tr>
            <tr>
                <td class="sr-no">11*</td>
                <td>Weighing slip no.</td>
                <td>AS PER ATTACHED SHEET</td>
            </tr>
            <tr>
                <td class="sr-no">12</td>
                <td>Type (Normal/Reefer/Hazardous/others)</td>
                <td><%= vgm.containerType || 'NORMAL' %></td>
            </tr>
            <tr>
                <td class="sr-no">13</td>
                <td>If Hazardous UN NO. IMDG class</td>
                <td>
                    <% if (vgm.containerType === 'HAZARDOUS' && (vgm.hazardousUnNo || vgm.imdgClass)) { %>
                        <%= vgm.hazardousUnNo || '' %><% if (vgm.hazardousUnNo && vgm.imdgClass) { %>, <% } %><%= vgm.imdgClass || '' %>
                    <% } else { %>
                        N. A
                    <% } %>
                </td>
            </tr>
        </tbody>
    </table>

    <table class="container-table">
        <thead>
            <tr>
                <th rowspan="2">SR.NO.</th>
                <th rowspan="2">CONTAINER NO.</th>
                <th rowspan="2">MAXIMUM GROSS WT. OF CONT. AS PER CSC PLATE</th>
                <th rowspan="2">VERIFIED GROSS MASS OF CONT./ <%= vgm.method.replace('_', '-' ) %>
                </th>
                <th rowspan="2">GROSS WT.OF GOODS</th>
                <th rowspan="2">TARE WT.OF CONT.AS PER CSC PLATE</th>
                <th rowspan="2">WEIGHING SLIP NO.</th>
                <th rowspan="2">DATE</th>
            </tr>
        </thead>
        <tbody>
            <% if (piInvoice.packagingSteps && piInvoice.packagingSteps.length > 0) { %>
                <% piInvoice.packagingSteps.forEach((step, index) => { %>
                    <tr>
                        <td><%= index + 1 %></td>
                        <td><%= step.containerNumber %></td>
                        <td><%= piInvoice.maxPermissibleWeight || '30480.00' %></td>
                        <td><%= vgm.verifiedGrossMass.toFixed(2) %></td>
                        <td><%= vgm.cargoWeight ? vgm.cargoWeight.toFixed(2) : (vgm.verifiedGrossMass - 2200).toFixed(2) %></td>
                        <td><%= vgm.containerTareWeight ? vgm.containerTareWeight.toFixed(2) : '2200.00' %></td>
                        <td><%= vgm.id.toString().padStart(3, '0') %></td>
                        <td><%= new Date(vgm.verificationDate).toLocaleDateString('en-GB') %></td>
                    </tr>
                <% }); %>
            <% } else { %>
                <tr>
                    <td>1</td>
                    <td><%= vgm.productPackagingStep?.containerNumber || 'N/A' %></td>
                    <td><%= piInvoice.maxPermissibleWeight || '30480.00' %></td>
                    <td><%= vgm.verifiedGrossMass.toFixed(2) %></td>
                    <td><%= vgm.cargoWeight ? vgm.cargoWeight.toFixed(2) : (vgm.verifiedGrossMass - 2200).toFixed(2) %></td>
                    <td><%= vgm.containerTareWeight ? vgm.containerTareWeight.toFixed(2) : '2200.00' %></td>
                    <td><%= vgm.id.toString().padStart(3, '0') %></td>
                    <td><%= new Date(vgm.verificationDate).toLocaleDateString('en-GB') %></td>
                </tr>
            <% } %>
        </tbody>
    </table>

    <div class="signature-section">
        <div class="signature-text">
            Signature of authorized person of shipper<br>
            Name- <%= vgm.verifiedBy.toUpperCase() %>
        </div>
        <div class="signature-space"></div>
    </div>
</body>

</html>